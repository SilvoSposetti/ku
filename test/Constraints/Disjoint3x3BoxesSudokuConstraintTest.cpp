#include "Disjoint3x3BoxesSudokuConstraint.hpp"

#include "ConstraintTestHelpers.hpp"

#include <doctest.h>

TEST_SUITE("Constraints") {

  TEST_CASE("Disjoint3x3BoxesSudokuConstraint") {

    SUBCASE("Members") {
      ConstraintTestHelpers::memberChecks<Disjoint3x3BoxesSudokuConstraint<PuzzleIntrinsics<{0, 0, 0}>{}>>();
    }

    SUBCASE("Implicit Option Coverage") {
      // Only works with sudoku puzzle
      GENERATE_SUBCASE(Disjoint3x3BoxesSudokuConstraint, 9, 9, 9);
    }

    SUBCASE("Not supported") {
      // Not 9 rows
      CHECK(!Disjoint3x3BoxesSudokuConstraint<PuzzleIntrinsics<{5, 9, 9}>{}>().supportsPuzzle());
      // Not 9 columns
      CHECK(!Disjoint3x3BoxesSudokuConstraint<PuzzleIntrinsics<{9, 12, 9}>{}>().supportsPuzzle());
      // Not 9 digits
      CHECK(!Disjoint3x3BoxesSudokuConstraint<PuzzleIntrinsics<{9, 9, 8}>{}>().supportsPuzzle());
    }

    SUBCASE("Explicit Options") {
      SUBCASE("9x9x9") {
        constexpr auto intrinsics = PuzzleIntrinsics<{9, 9, 9}>{};
        ConstraintTestHelpers::checkConstraintOptions<intrinsics, 1, 0>(
            Disjoint3x3BoxesSudokuConstraint<intrinsics>(),
            81,
            std::vector<Option<1>>{
                {0},  {1},  {2},  {3},  {4},  {5},  {6},  {7},  {8},  {9},  {10}, {11}, {12}, {13}, {14}, {15}, {16},
                {17}, {18}, {19}, {20}, {21}, {22}, {23}, {24}, {25}, {26}, {0},  {1},  {2},  {3},  {4},  {5},  {6},
                {7},  {8},  {9},  {10}, {11}, {12}, {13}, {14}, {15}, {16}, {17}, {18}, {19}, {20}, {21}, {22}, {23},
                {24}, {25}, {26}, {0},  {1},  {2},  {3},  {4},  {5},  {6},  {7},  {8},  {9},  {10}, {11}, {12}, {13},
                {14}, {15}, {16}, {17}, {18}, {19}, {20}, {21}, {22}, {23}, {24}, {25}, {26}, {27}, {28}, {29}, {30},
                {31}, {32}, {33}, {34}, {35}, {36}, {37}, {38}, {39}, {40}, {41}, {42}, {43}, {44}, {45}, {46}, {47},
                {48}, {49}, {50}, {51}, {52}, {53}, {27}, {28}, {29}, {30}, {31}, {32}, {33}, {34}, {35}, {36}, {37},
                {38}, {39}, {40}, {41}, {42}, {43}, {44}, {45}, {46}, {47}, {48}, {49}, {50}, {51}, {52}, {53}, {27},
                {28}, {29}, {30}, {31}, {32}, {33}, {34}, {35}, {36}, {37}, {38}, {39}, {40}, {41}, {42}, {43}, {44},
                {45}, {46}, {47}, {48}, {49}, {50}, {51}, {52}, {53}, {54}, {55}, {56}, {57}, {58}, {59}, {60}, {61},
                {62}, {63}, {64}, {65}, {66}, {67}, {68}, {69}, {70}, {71}, {72}, {73}, {74}, {75}, {76}, {77}, {78},
                {79}, {80}, {54}, {55}, {56}, {57}, {58}, {59}, {60}, {61}, {62}, {63}, {64}, {65}, {66}, {67}, {68},
                {69}, {70}, {71}, {72}, {73}, {74}, {75}, {76}, {77}, {78}, {79}, {80}, {54}, {55}, {56}, {57}, {58},
                {59}, {60}, {61}, {62}, {63}, {64}, {65}, {66}, {67}, {68}, {69}, {70}, {71}, {72}, {73}, {74}, {75},
                {76}, {77}, {78}, {79}, {80}, {0},  {1},  {2},  {3},  {4},  {5},  {6},  {7},  {8},  {9},  {10}, {11},
                {12}, {13}, {14}, {15}, {16}, {17}, {18}, {19}, {20}, {21}, {22}, {23}, {24}, {25}, {26}, {0},  {1},
                {2},  {3},  {4},  {5},  {6},  {7},  {8},  {9},  {10}, {11}, {12}, {13}, {14}, {15}, {16}, {17}, {18},
                {19}, {20}, {21}, {22}, {23}, {24}, {25}, {26}, {0},  {1},  {2},  {3},  {4},  {5},  {6},  {7},  {8},
                {9},  {10}, {11}, {12}, {13}, {14}, {15}, {16}, {17}, {18}, {19}, {20}, {21}, {22}, {23}, {24}, {25},
                {26}, {27}, {28}, {29}, {30}, {31}, {32}, {33}, {34}, {35}, {36}, {37}, {38}, {39}, {40}, {41}, {42},
                {43}, {44}, {45}, {46}, {47}, {48}, {49}, {50}, {51}, {52}, {53}, {27}, {28}, {29}, {30}, {31}, {32},
                {33}, {34}, {35}, {36}, {37}, {38}, {39}, {40}, {41}, {42}, {43}, {44}, {45}, {46}, {47}, {48}, {49},
                {50}, {51}, {52}, {53}, {27}, {28}, {29}, {30}, {31}, {32}, {33}, {34}, {35}, {36}, {37}, {38}, {39},
                {40}, {41}, {42}, {43}, {44}, {45}, {46}, {47}, {48}, {49}, {50}, {51}, {52}, {53}, {54}, {55}, {56},
                {57}, {58}, {59}, {60}, {61}, {62}, {63}, {64}, {65}, {66}, {67}, {68}, {69}, {70}, {71}, {72}, {73},
                {74}, {75}, {76}, {77}, {78}, {79}, {80}, {54}, {55}, {56}, {57}, {58}, {59}, {60}, {61}, {62}, {63},
                {64}, {65}, {66}, {67}, {68}, {69}, {70}, {71}, {72}, {73}, {74}, {75}, {76}, {77}, {78}, {79}, {80},
                {54}, {55}, {56}, {57}, {58}, {59}, {60}, {61}, {62}, {63}, {64}, {65}, {66}, {67}, {68}, {69}, {70},
                {71}, {72}, {73}, {74}, {75}, {76}, {77}, {78}, {79}, {80}, {0},  {1},  {2},  {3},  {4},  {5},  {6},
                {7},  {8},  {9},  {10}, {11}, {12}, {13}, {14}, {15}, {16}, {17}, {18}, {19}, {20}, {21}, {22}, {23},
                {24}, {25}, {26}, {0},  {1},  {2},  {3},  {4},  {5},  {6},  {7},  {8},  {9},  {10}, {11}, {12}, {13},
                {14}, {15}, {16}, {17}, {18}, {19}, {20}, {21}, {22}, {23}, {24}, {25}, {26}, {0},  {1},  {2},  {3},
                {4},  {5},  {6},  {7},  {8},  {9},  {10}, {11}, {12}, {13}, {14}, {15}, {16}, {17}, {18}, {19}, {20},
                {21}, {22}, {23}, {24}, {25}, {26}, {27}, {28}, {29}, {30}, {31}, {32}, {33}, {34}, {35}, {36}, {37},
                {38}, {39}, {40}, {41}, {42}, {43}, {44}, {45}, {46}, {47}, {48}, {49}, {50}, {51}, {52}, {53}, {27},
                {28}, {29}, {30}, {31}, {32}, {33}, {34}, {35}, {36}, {37}, {38}, {39}, {40}, {41}, {42}, {43}, {44},
                {45}, {46}, {47}, {48}, {49}, {50}, {51}, {52}, {53}, {27}, {28}, {29}, {30}, {31}, {32}, {33}, {34},
                {35}, {36}, {37}, {38}, {39}, {40}, {41}, {42}, {43}, {44}, {45}, {46}, {47}, {48}, {49}, {50}, {51},
                {52}, {53}, {54}, {55}, {56}, {57}, {58}, {59}, {60}, {61}, {62}, {63}, {64}, {65}, {66}, {67}, {68},
                {69}, {70}, {71}, {72}, {73}, {74}, {75}, {76}, {77}, {78}, {79}, {80}, {54}, {55}, {56}, {57}, {58},
                {59}, {60}, {61}, {62}, {63}, {64}, {65}, {66}, {67}, {68}, {69}, {70}, {71}, {72}, {73}, {74}, {75},
                {76}, {77}, {78}, {79}, {80}, {54}, {55}, {56}, {57}, {58}, {59}, {60}, {61}, {62}, {63}, {64}, {65},
                {66}, {67}, {68}, {69}, {70}, {71}, {72}, {73}, {74}, {75}, {76}, {77}, {78}, {79}, {80},
            },
            0,
            {});
      }
    }

    SUBCASE("Drawing") {

      SUBCASE("9x9x9") {
        constexpr auto space = PuzzleSpace{9, 9, 9};
        const auto expected = R"(<g id="Disjoint-Boxes" fill="transparent" stroke="black" stroke-width="0.889">
<circle cx="13.889" cy="13.889" r="7.407"/>
<circle cx="13.889" cy="166.667" r="7.407"/>
<circle cx="13.889" cy="319.444" r="7.407"/>
<circle cx="13.889" cy="347.222" r="7.407"/>
<circle cx="13.889" cy="500" r="7.407"/>
<circle cx="13.889" cy="652.778" r="7.407"/>
<circle cx="13.889" cy="680.556" r="7.407"/>
<circle cx="13.889" cy="833.333" r="7.407"/>
<circle cx="13.889" cy="986.111" r="7.407"/>
<circle cx="166.667" cy="13.889" r="7.407"/>
<circle cx="166.667" cy="166.667" r="7.407"/>
<circle cx="166.667" cy="319.444" r="7.407"/>
<circle cx="166.667" cy="347.222" r="7.407"/>
<circle cx="166.667" cy="500" r="7.407"/>
<circle cx="166.667" cy="652.778" r="7.407"/>
<circle cx="166.667" cy="680.556" r="7.407"/>
<circle cx="166.667" cy="833.333" r="7.407"/>
<circle cx="166.667" cy="986.111" r="7.407"/>
<circle cx="319.444" cy="13.889" r="7.407"/>
<circle cx="319.444" cy="166.667" r="7.407"/>
<circle cx="319.444" cy="319.444" r="7.407"/>
<circle cx="319.444" cy="347.222" r="7.407"/>
<circle cx="319.444" cy="500" r="7.407"/>
<circle cx="319.444" cy="652.778" r="7.407"/>
<circle cx="319.444" cy="680.556" r="7.407"/>
<circle cx="319.444" cy="833.333" r="7.407"/>
<circle cx="319.444" cy="986.111" r="7.407"/>
<circle cx="347.222" cy="13.889" r="7.407"/>
<circle cx="347.222" cy="166.667" r="7.407"/>
<circle cx="347.222" cy="319.444" r="7.407"/>
<circle cx="347.222" cy="347.222" r="7.407"/>
<circle cx="347.222" cy="500" r="7.407"/>
<circle cx="347.222" cy="652.778" r="7.407"/>
<circle cx="347.222" cy="680.556" r="7.407"/>
<circle cx="347.222" cy="833.333" r="7.407"/>
<circle cx="347.222" cy="986.111" r="7.407"/>
<circle cx="500" cy="13.889" r="7.407"/>
<circle cx="500" cy="166.667" r="7.407"/>
<circle cx="500" cy="319.444" r="7.407"/>
<circle cx="500" cy="347.222" r="7.407"/>
<circle cx="500" cy="500" r="7.407"/>
<circle cx="500" cy="652.778" r="7.407"/>
<circle cx="500" cy="680.556" r="7.407"/>
<circle cx="500" cy="833.333" r="7.407"/>
<circle cx="500" cy="986.111" r="7.407"/>
<circle cx="652.778" cy="13.889" r="7.407"/>
<circle cx="652.778" cy="166.667" r="7.407"/>
<circle cx="652.778" cy="319.444" r="7.407"/>
<circle cx="652.778" cy="347.222" r="7.407"/>
<circle cx="652.778" cy="500" r="7.407"/>
<circle cx="652.778" cy="652.778" r="7.407"/>
<circle cx="652.778" cy="680.556" r="7.407"/>
<circle cx="652.778" cy="833.333" r="7.407"/>
<circle cx="652.778" cy="986.111" r="7.407"/>
<circle cx="680.556" cy="13.889" r="7.407"/>
<circle cx="680.556" cy="166.667" r="7.407"/>
<circle cx="680.556" cy="319.444" r="7.407"/>
<circle cx="680.556" cy="347.222" r="7.407"/>
<circle cx="680.556" cy="500" r="7.407"/>
<circle cx="680.556" cy="652.778" r="7.407"/>
<circle cx="680.556" cy="680.556" r="7.407"/>
<circle cx="680.556" cy="833.333" r="7.407"/>
<circle cx="680.556" cy="986.111" r="7.407"/>
<circle cx="833.333" cy="13.889" r="7.407"/>
<circle cx="833.333" cy="166.667" r="7.407"/>
<circle cx="833.333" cy="319.444" r="7.407"/>
<circle cx="833.333" cy="347.222" r="7.407"/>
<circle cx="833.333" cy="500" r="7.407"/>
<circle cx="833.333" cy="652.778" r="7.407"/>
<circle cx="833.333" cy="680.556" r="7.407"/>
<circle cx="833.333" cy="833.333" r="7.407"/>
<circle cx="833.333" cy="986.111" r="7.407"/>
<circle cx="986.111" cy="13.889" r="7.407"/>
<circle cx="986.111" cy="166.667" r="7.407"/>
<circle cx="986.111" cy="319.444" r="7.407"/>
<circle cx="986.111" cy="347.222" r="7.407"/>
<circle cx="986.111" cy="500" r="7.407"/>
<circle cx="986.111" cy="652.778" r="7.407"/>
<circle cx="986.111" cy="680.556" r="7.407"/>
<circle cx="986.111" cy="833.333" r="7.407"/>
<circle cx="986.111" cy="986.111" r="7.407"/>
</g>)";
        ConstraintTestHelpers::checkConstraintSvg<space, Disjoint3x3BoxesSudokuConstraint<PuzzleIntrinsics<space>{}>>(
            expected);
      }
    }
  }
}
